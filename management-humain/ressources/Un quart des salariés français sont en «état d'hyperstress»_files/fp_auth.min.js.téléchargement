var fpauthentificator=function(){this.screenThresholdWidth=768,this.responsiveRun=window.innerWidth<this.screenThresholdWidth,this.everInitialized=!1,this.currentElementOperation=!1,this.currentElementType=!1,this.currentElementCallback=!1,this.currentActionPremium=!1,this.currentFormButton=null,this.recocurrentOperationKey=null,this.recocurrentOperationType=null,this.user=!1,this.passport=!1,this.urlRegexp="((http|https):((//)|(\\\\))+[wd:#@%/;$()~_?+-=\\.&]*)","undefined"!=typeof fpAuthPassport?this.setPassport(fpAuthPassport):this.setPassport({appId:"81325031242245596367369127435013",defautlFormValues:{"data-formlevel":"middle","data-public":"1","data-update":"0"}}),this.divs=[],this.links=[],this.elementsToGetClassName="fpAuth",this.knownElements=[],this.knownElements.forms=[],this.knownElements.links=[],this.knownElementsClassName="fp-auth-known-elements",this.defaultPremiumHost="plus.lefigaro.fr","undefined"!=typeof premiumServicesHost&&premiumServicesHost.match(this.urlRegexp)?this.premiumHost="/"===premiumServicesHost.slice(-1)?premiumServicesHost.slice(0,-1):premiumServicesHost:this.premiumHost=document.location.protocol+"//"+this.defaultPremiumHost;var e=["/sites/default/modules/fp/fp_com_action/themes/css/fp_com_action.css","/sites/default/modules/fp/fp_user_services/themes/css/fp_auth_api.css"];for(var t in e)if(e.hasOwnProperty(t)){var n={type:"link",attributes:{type:"text/css",rel:"stylesheet",media:"all",href:this.premiumHost+e[t]}};this.insertDomElement(n)}this.mainCommentAlreadySent=[],this.commentFormcontainer=[],this.commentFormTextarea=[],this.commentLengthcounter=!1,this.definedCommentValue=!1,this.maxCommentLength=1500,this.checkUserCookie(!1),this.recolinksType=["recommander","suivre","suivretag","selectionner"],this.recolinksContainerClasses=["recommander-container","fpApp-suivre-container","fpApp-suivretag-container","selectionner-container"],this.recolinks=[],this.recolinksInfos=[],this.recogetInfos=[],this.recoqueries=[],this.recolinksDatas=[],this.recolinksContainer=[],this.recocontainerClassName=[];for(var o=0;o<this.recolinksType.length;o++)this.recolinks[this.recolinksType[o]]=[],this.recolinksInfos[this.recolinksType[o]]=[],this.recolinksDatas[this.recolinksType[o]]=[],this.recolinksContainer[this.recolinksType[o]]=[],this.recocontainerClassName[this.recolinksType[o]]=this.recolinksContainerClasses[o];this.recorecommanderLinksCountClassName="recommander-count",this.attachMessageListener(),this.onload()};fpauthentificator.prototype.init=function(){var e=this;return e.blocked?!1:(e.everInitialized=!0,e.passport?void(e.openFpPwdDialogBox()||e.postInit()):("undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("Erreur fpAuth : Probleme de definition du passport"),!1))},fpauthentificator.prototype.postInit=function(){var myObj=this;if(myObj.scanPageForNewElements(),myObj.pingFidji(),myObj.responsiveRun){var tmpCookie=myObj.getCookie("fp-auth-data");myObj.setCookie("fp-auth-data","",-1),tmpCookie&&(cookieJson=eval("("+tmpCookie+")"),myObj.recocurrentOperationKey=cookieJson.recocurrentOperationKey,myObj.recocurrentOperationType=cookieJson.recocurrentOperationType,myObj.currentElementCallback=cookieJson.currentElementCallback,myObj.currentActionPremium=cookieJson.currentActionPremium,myObj.currentElementOperation=myObj.knownElements[myObj.recocurrentOperationType][myObj.recocurrentOperationKey],"function"==typeof eval(myObj.currentElementCallback)&&(myObj.currentElementOperation.hasAttribute("data-arg")?eval(myObj.currentElementCallback+"("+myObj.currentElementOperation.getAttribute("data-arg")+")"):eval(myObj.currentElementCallback+"()")))}},fpauthentificator.prototype.scanPageForNewElements=function(){var e=this;e.searchNewRecoLinks(),e.getNewElements(),e.setForms(),e.setButtons()},fpauthentificator.prototype.getNewElements=function(){var e,t=this;for(t.divs=document.getElementsByTagName("div"),e=0;e<t.divs.length;e++)t.divs[e].hasAttribute("class")&&t.divs[e].getAttribute("class").match(t.elementsToGetClassName)&&!t.divs[e].className.match(t.knownElementsClassName)&&(t.knownElements.forms[t.knownElements.forms.length]=t.divs[e]);for(t.links=document.getElementsByTagName("a"),e=0;e<t.links.length;e++)t.links[e].hasAttribute("class")&&t.links[e].getAttribute("class").match(t.elementsToGetClassName)&&!t.links[e].className.match(t.knownElementsClassName)&&(t.knownElements.links[t.knownElements.links.length]=t.links[e],t.links[e].className+=" "+t.knownElementsClassName)},fpauthentificator.prototype.setForms=function(){var e,t,n=this;if(n.knownElements.forms.length>0)for(var o=0;o<n.knownElements.forms.length;o++)if(!n.knownElements.forms[o].className.match(n.knownElementsClassName)){n.knownElements.forms[o].className+=" "+n.knownElementsClassName;var r=n.knownElements.forms[o].getAttribute("data-type");switch(r){case"form":var a=n.knownElements.forms[o].getAttribute("data-actionpremium")?!0:!1,i=n.buildParcoursPath(n.knownElements.forms[o],"login",n.knownElements.forms[o].getAttribute("data-goto"),a);t=i.main+i["goto"],e=document.createElement("iframe"),e.src=t,e.className="fp-auth-iframe-form",n.knownElements.forms[o].appendChild(e);break;case"comment-form":var s=n.knownElements.forms[o];if(s.getAttribute("data-nodenid")){var c=n.commentFormcontainer.length;n.commentFormcontainer[c]=s,n.buildMainCommentForm(c)}break;case"comment-list":n.commentsListContainer=n.knownElements.forms[o],n.commentsList=[],n.commentsList.pages=[],n.commentsList.currentPage=1;var l=0;n.requestCommentListPage(l)}}},fpauthentificator.prototype.getParentByClassName=function(e,t){for(var n=null,o=e.parentNode;null!==o;){if(o.className&&""!=o.className){var r=o.className.split(" ");for(var a in r)if(r[a]==t){n=o;break}}var i=o;o=i.parentNode}return n},fpauthentificator.prototype.attachMessageListener=function(){window.addEventListener?addEventListener("message",fpAuthentificatorMessageDispatcher,!1):attachEvent("onmessage",fpAuthentificatorMessageDispatcher)},fpauthentificator.prototype.openFpPwdDialogBox=function(e){var t=this,n=t.getCookie("figaro_pwd");if(n){if(t.resetPwd=!0,1==n)return t.openFpUserDialogBox(t.premiumHost+"/fpservice/password_reset"),!0;if("error"==n.substring(0,5)){var o=document.location.hostname+document.location.pathname;return t.openFpUserDialogBox(t.premiumHost+"/fpservice/password?goto_url="+encodeURIComponent(o)+"&error="+n),!0}}return!1};var fpAuthentificatorMessageDispatcher=function(event){var myObj=fpAuth;if(event&&event.data&&"string"==typeof event.data){var es=event.data.split("__");switch(es[0]){case"iframe":switch(es[1]){case"goto":if("lostpassword"==es[2]){var gotoUrl=myObj.premiumHost+"/fpservice/password?goto_url="+encodeURIComponent(document.location.hostname+document.location.pathname);myObj.openFpUserDialogBox(gotoUrl)}break;case"closeframe":return myObj.closeFpUserDialogBox(),!1;case"resize":myObj.resizeIframe(es[2]);break;case"refresh_popup":myObj.refreshIFrame();break;case"execute_callback":var callback=decodeURIComponent(es[2]);myObj.checkUserCookie(!1),myObj.hideFrames(),callback.match(myObj.urlRegexp)?window.location.href=callback:"function"==typeof callback||"function"==typeof eval(callback)?myObj.currentElementOperation&&myObj.currentElementOperation.hasAttribute("data-arg")?eval(callback+"("+myObj.currentElementOperation.getAttribute("data-arg")+")"):eval(callback+"()"):refresh_parent_page()}}}};fpauthentificator.prototype.refreshIFrame=function(){var e=document.getElementById("fp-dialog-iframe");if(e)e.src+="&socially_logged=1";else{var t=document.getElementsByTagName("iframe");for(var n in t)"object"==typeof t[n]&&t[n].hasAttribute("class")&&t[n].className.match("fp-auth-iframe-form")&&(t[n].src+="&socially_logged=1")}},fpauthentificator.prototype.hideFrames=function(){var e=this;if(e.currentActionPremium)e.closeFpUserDialogBox();else{var t=document.getElementsByTagName("iframe");for(var n in t)"object"==typeof t[n]&&t[n].hasAttribute("class")&&t[n].className.match("fp-auth-iframe-form")&&(t[n].style.display="none")}},fpauthentificator.prototype.buildMainCommentForm=function(e){var t,n=this;"undefined"!=typeof e?(t=e,n.commentFormcontainer[e].hasAttribute("data-cfiid")||n.commentFormcontainer[e].setAttribute("data-cfiid",e)):n.currentElementOperation&&(t=n.currentElementOperation.getAttribute("data-cfiid")),n.buildCommentForm(n.commentFormcontainer[t],"fpAuth.buildMainCommentForm","fpAuth.sendMainComment")},fpauthentificator.prototype.buildAnswerCommentForm=function(){var e=this;if("null"==e.passport.commentReplyContainerClass)return"undefined"!=typeof window.parent.console&&"function"==typeof window.parent.console.log&&window.parent.console.log("fpAuth::Debug::Unknown comment class separator."),void(e.currentElementOperation.style.display="none");var t="fpAuthcommentReplyForm-"+e.currentElementOperation.getAttribute("data-cid"),n=document.getElementById(t);if(!n){e.currentElementOperation.style.display="none";var o=e.getParentByClassName(e.currentElementOperation,e.passport.commentReplyContainerClass);if(null==o)return"undefined"!=typeof window.parent.console&&"function"==typeof window.parent.console.log&&window.parent.console.log("fpAuth::Debug::There is no way this parent exists."),void(e.currentElementOperation.style.display="none");n=document.createElement("div"),n.id=t,n.className="fpAuth comment-reply",n.setAttribute("data-type","comment-form"),n.setAttribute("data-nodenid",e.currentElementOperation.getAttribute("data-nid")),n.setAttribute("data-cid",e.currentElementOperation.getAttribute("data-cid"));var r=e.currentElementOperation.getAttribute("data-url");r&&r.match(e.urlRegexp)&&n.setAttribute("data-url",r),o.parentNode.insertBefore(n,o.nextSibling)}e.buildCommentForm(n,"fpAUth.buildAnswerCommentForm","fpAuth.sendReplyComment")},fpauthentificator.prototype.buildCommentForm=function(e,t,n){var o=this;document.getElementById("fpAuth-comment-form-value")&&""!=document.getElementById("fpAuth-comment-form-value").value&&(o.definedCommentValue=decodeURIComponent(document.getElementById("fpAuth-comment-form-value").value.replace(/\+/g," "))),o.user?o.availableUserForPost?o.loadCommentFormHtml(e,n):o.loadUnPublicCommentFormHtml(e,t):o.loadUnloggedCommentFormHtml(e,t)},fpauthentificator.prototype.loadUnloggedCommentFormHtml=function(e,t){var n,o,r,a=this;e.innerHTML="",n=document.createElement("p"),n.className="unlogged",r=document.createElement("h6"),r.innerHTML="Pour commenter cet article, veuillez vous connecter avec votre compte Mon Figaro.",e.appendChild(n),n.appendChild(r),o=document.createElement("a"),o.className="fpAuth fpAuth-button bleu",o.href="#",o.setAttribute("data-type","action"),o.setAttribute("data-action",t),o.setAttribute("data-arg",e.getAttribute("data-cfiid")),o.setAttribute("data-actionpremium","true"),o.setAttribute("data-public","1"),o.setAttribute("data-update","0"),o.setAttribute("data-formlevel","middle"),o.innerHTML="Connexion",n.appendChild(o),a.getNewElements()},fpauthentificator.prototype.loadUnPublicCommentFormHtml=function(e,t){var n,o,r,a,i,s,c,l=this;e.innerHTML="",n=document.createElement("p"),n.className="unlogged",r=document.createElement("h6"),r.innerHTML="Pour commenter cet article, complétez votre profil public.",e.appendChild(n),n.appendChild(r),a=document.createElement("span"),a.innerHTML="Il vous permet de :",n.appendChild(a),i=document.createElement("ul"),s=document.createElement("li"),c=document.createElement("li"),n.appendChild(i),s.innerHTML="commenter et recommander les articles",c.innerHTML="suivre les journalistes et thématiques qui vous intéressent",i.appendChild(s),i.appendChild(c),o=document.createElement("a"),o.className="fpAuth fpAuth-button bleu",o.href="#",o.setAttribute("data-type","action"),o.setAttribute("data-action",t),o.setAttribute("data-arg",e.getAttribute("data-cfiid")),o.setAttribute("data-actionpremium","true"),o.setAttribute("data-public","1"),o.setAttribute("data-update","0"),o.setAttribute("data-formlevel","middle"),o.innerHTML="activer mon profil public";var m=document.createElement("span");n.appendChild(m),m.appendChild(o),l.getNewElements()},fpauthentificator.prototype.loadCommentFormHtml=function(e,t){var n,o,r,a,i,s,c,l,m,p,u=this,d=e.getAttribute("data-cfiid");e.innerHTML="",s=document.createElement("p"),s.style.display="none",e.appendChild(s),i=document.createElement("form"),i.className="fpAuth-comment-form",e.appendChild(i),n=document.createElement("div"),n.className="avatar-wrapper";var f="";f=u.user.url.toString().match("/page/")?u.user.url.toString():u.premiumHost+"/page/uid/"+u.user.uid.toString();var h=document.createElement("a");h.href=f,h.className="avatar",o=document.createElement("img"),o.src=u.premiumHost+"/sites/default/files/"+u.user.picture.toString(),o.alt="Avatar de : "+decodeURIComponent(u.user.name.toString().replace(/\+/g," ")),h.appendChild(o);var g=document.createElement("b");g.className="arrow",h.appendChild(g),n.appendChild(h),a=document.createElement("a"),a.href=f,a.innerHTML=decodeURIComponent(u.user.name.toString().replace(/\+/g," ")),a.title="Aller sur ma page",r=document.createElement("p"),r.className="username",r.appendChild(a),n.appendChild(r),i.appendChild(n),c=document.createElement("textarea"),c.placeholder="Ecrivez votre commentaire ...",c.className="fpAuth-comment-textarea",u.definedCommentValue&&(c.value=u.definedCommentValue),u.commentFormTextarea[d]=c,i.appendChild(c),l=document.createElement("div"),l.innerHTML="Les commentaires sont limit&eacute;s à "+u.maxCommentLength+" caract&egrave;res",l.className="fpAuth-comment-form-description",i.appendChild(l),p=document.createElement("span"),p.className="comment-lentgh-counter",p.innerHTML="0/"+u.maxCommentLength,u.commentLengthcounter=p,l.appendChild(p),m=document.createElement("button"),m.className="fpAuth-button bleu",m.innerHTML="Valider";var y='{"customCategorieBU": "navigation", "customActionBU": "enrichment", "customLabelBUcustomCategorieSPE": "commentaires","customIDSPE": "'+e.getAttribute("data-nodenid")+'", "customSiteNameSPE": "'+document.domain+'", "customActionSPE": "enrichment", "event" : "customEventBUSPE"}';m.setAttribute("data-gtm",y),i.appendChild(m),c.onkeyup=function(){this.value.length>=u.maxCommentLength&&(this.value=this.value.substr(0,u.maxCommentLength)),u.commentLengthcounter.innerHTML=this.value.length+"/"+u.maxCommentLength};var k=u.buildParcoursPath(e,"commentForm",t,!0),v=k.main+"&js=true"+k["goto"],b={type:"script",attributes:{type:"text/javascript",src:v}};u.definedCommentValue&&0==u.commentAlreadySent[d]&&(u.currentElementOperation=e,u.currentElementType="commentForm",u.currentElementCallback=t,u.currentActionPremium=!0,u.insertDomElement(b)),m.onclick=function(){return u.currentFormButton=this,u.currentElementOperation=e,u.currentElementType="commentForm",u.currentElementCallback=t,u.currentActionPremium=!0,""!=c.value&&(u.definedCommentValue||u.availableUserForPost?u.insertDomElement(b):u.openFpUserDialogBox(k.main+k["goto"])),!1}},fpauthentificator.prototype.refreshCommentForm=function(){var e=this,t=e.currentElementOperation,n=t.getAttribute("data-cfiid");e.commentFormTextarea[n]&&(e.checkUserCookie(!0),e.buildCommentForm(t),e.closeFpUserDialogBox())},fpauthentificator.prototype.sendReplyComment=function(){var e=this,t=e.getParentByClassName(e.currentFormButton,"fpAuth");e.sendComment(t,t.getElementsByTagName("textarea")[0],"fpauthentificatorReplyCommentSent",t.id)},fpauthentificator.prototype.sendMainComment=function(){var e=this,t=e.currentElementOperation.getAttribute("data-cfiid");e.mainCommentAlreadySent[t]||(e.mainCommentAlreadySent[t]=!0,e.sendComment(e.commentFormcontainer[t],e.commentFormTextarea[t],"fpauthentificatorMainCommentSent",t))},fpauthentificator.prototype.sendComment=function(e,t,n,o){var r=this;e.className+=" fpAuth-form-loading";var a=r.passport.appId,i=e.getAttribute("data-nodenid"),s=e.getAttribute("data-cid")?e.getAttribute("data-cid"):0,c=encodeURIComponent(t.value.substr(0,r.maxCommentLength)),l=r.premiumHost+"/jsonp/save_comment?callback="+n+"&app_id="+a+"&parent_cid="+s+"&content_id="+i+"&form_id="+o,m="";m=e.getAttribute("data-url")?e.getAttribute("data-url"):document.location.href.replace(document.location.hash,""),l+="&url_recup="+encodeURIComponent(m),l+="&comment="+c;var p={type:"script",attributes:{type:"text/javascript",src:l}};r.insertDomElement(p)};var fpauthentificatorReplyCommentSent=function(e){var t=window.fpAuth,n=e.request.form_id,o=document.getElementById(n);0==e.status&&"not_logged_in"!=e.error&&(o.getElementsByTagName("form")[0].innerHTML=""),o&&t.commentSent(o,e,"fpAuth.sendReplyComment")},fpauthentificatorMainCommentSent=function(e){var t=window.fpAuth,n=e.request.form_id;0==e.status&&(t.mainCommentAlreadySent[n]=!1),t.commentSent(t.commentFormcontainer[n],e,"fpAuth.sendMainComment")};fpauthentificator.prototype.commentSent=function(e,t,n){var o,r,a=this;if(e.className=e.className.replace("fpAuth-form-loading",""),0==t.status)if(e.className=e.className.replace("fpAuth-form-loading",""),"not_logged_in"==t.error){var i=a.buildParcoursPath(e,"commentForm",n,!0);a.openFpUserDialogBox(i.main+i["goto"])}else"flood"==t.error?o=a.commentStatusMessages(t.error):(o=a.commentStatusMessages("default"),"undefined"!=typeof console&&"function"==typeof console.log&&console.log(a.commentStatusMessages(t.error))),r="error";else r="status",o=1==t.data.published?a.commentStatusMessages("success"):a.commentStatusMessages("moderation");if(o){var s;s=e.getElementsByTagName("p")[0],s.style.display="block",s.className=r;for(var c in o)o[c].target=s,a.insertDomElement(o[c]);"status"==r&&(e.getElementsByTagName("form")[0].innerHTML="")}},fpauthentificator.prototype.commentStatusMessages=function(e){var t,n=[],o={thx:{type:"h6",children:[{type:"text",value:"Merci pour votre commentaire"}]},charte:{type:"a",attributes:{href:document.location.protocol+"//www.lefigaro.fr/charte_moderation/charte_moderation.html",target:"_blank"},children:[{type:"text",value:"notre charte"}]}};switch(e){case"success":n[n.length]={type:"div",children:[o.thx,{type:"text",value:"il est publié provisoirement et soumis à modération en priorité. Il sera validé s'il respecte "},o.charte,{type:"text",value:"."}]};break;case"moderation":n[n.length]={type:"div",children:[o.thx,{type:"text",value:"Il est enregistré et soumis à modération. Il sera publié s'il est conforme à "},o.charte,{type:"text",value:"."}]};break;case"flood":n[n.length]={type:"text",value:"Vous avez posté trop de commentaires dans l’heure écoulée, veuillez essayer ultérieurement."};break;case"default":n[n.length]={type:"text",value:"Une erreur est survenue lors de l'envoi de votre commentaire, veuillez essayer ultérieurement."};break;case"unknown_user":t="Code erreur : unknown_user - Compte inconnue.";break;case"unauthorized_user":t="Code erreur : unauthorized_user - Compte non autorisé à poster des commentaires.";break;case"unknown_article":t="Code erreur :  unknown_article  - Article est invalide.";break;case"comments_closed":t="Code erreur : comments_closed - Article non ouvert aux commentaires.";break;case"comment_too_long":t="Code erreur : comment_too_long - Texte du commentaire posté est trop long."}return t?t:n},fpauthentificator.prototype.requestCommentListPage=function(e){var t=this,n=t.passport.appId,o=t.commentsListContainer.getAttribute("data-nodenid"),r=t.commentsListContainer.getAttribute("data-parentslimit")?t.commentsListContainer.getAttribute("data-parentslimit"):0,a=t.commentsListContainer.getAttribute("data-commentslimit")?t.commentsListContainer.getAttribute("data-commentslimit"):0;if(o){var i=t.premiumHost+"/jsonp/comments_list?callback=fpAuthBuildCommentsList&app_id="+n+"&page="+e+"&parents_limit="+r+"&comments_limit="+a+"&remote_id="+o;for(var s in t.sitesWithUnknowRetrievingUrl)t.passport.appId==t.sitesWithUnknowRetrievingUrl[s]&&(i+="&url="+encodeURIComponent(document.location.href.replace(document.location.hash,"")));var c={type:"script",attributes:{type:"text/javascript",src:i}};t.insertDomElement(c)}},fpauthentificator.prototype.buildCommentsCurrentPage=function(e){var t=this;if(t.commentsList.pages[e]){var n;if(0==t.commentsListContainer.getElementsByTagName("h3").length){var o=document.createElement("h3");o.innerHTML="Tous les commentaires",n=document.createElement("div"),n.className="comments-list-wrapper",t.commentsListContainer.appendChild(o),t.commentsListContainer.appendChild(n),t.commentsList.commentsWrapper=n}if(!t.commentsList.commentsWrapper.childNodes[e]){commentsPage=document.createElement("div"),commentsPage.className="comments-page-"+e,t.commentsList.commentsWrapper.appendChild(commentsPage);var r,a,i,s,c,l,m;for(var p in t.commentsList.pages[e]){m=t.commentsList.pages[e][p],r=document.createElement("article"),a=document.createElement("div"),a.className="author-name",i=document.createElement("a"),i.href=m.user_page,i.innerHTML=m.user_name,s=document.createElement("span"),s.className="comment-posted";var u=new Date(1e3*parseInt(m.timestamp));c=u.getDate()+"/"+(u.getMonth()+1)+"/"+u.getFullYear()+" - "+u.getHours()+":"+u.getMinutes(),s.innerHTML=c,l=document.createElement("div"),l.className="comment-story description",l.innerHTML=m.comment,commentsPage.appendChild(r),r.appendChild(a),a.appendChild(i),a.appendChild(s),r.appendChild(l)}}if(0==e&&t.commentsList.pages_count>1){var d,f,h,g;d=document.createElement("nav"),f=document.createElement("span"),h=document.createElement("button"),g=document.createElement("button"),h.innerHTML="Page précédente",g.innerHTML="Page suivante",f.innerHTML=t.commentsList.currentPage+" / "+t.commentsList.pages_count,d.style.textAlign="center",d.style.padding="5px",d.style.position="relative",h.style.position="absolute",h.style.left="5px",h.style.display="none",g.style.position="absolute",g.style.right="5px",t.commentsListContainer.appendChild(d),d.appendChild(f),d.appendChild(h),d.appendChild(g),t.commentsList.nextButton=g,t.commentsList.previousButton=h,t.commentsList.numPage=f,g.onclick=function(){return t.showCommentPage("next"),!1},h.onclick=function(){return t.showCommentPage("previous"),!1}}}},fpauthentificator.prototype.showCommentPage=function(e){var t,n=this;if("next"==e){if(n.commentsList.currentPage<n.commentsList.pages_count){n.commentsList.currentPage+=1,n.commentsList.numPage.innerHTML=n.commentsList.currentPage+" / "+n.commentsList.pages_count,n.commentsList.currentPage>=n.commentsList.pages_count&&(n.commentsList.nextButton.style.display="none"),n.commentsList.previousButton.style.display="inline";for(t in n.commentsList.commentsWrapper.childNodes)(1==n.commentsList.commentsWrapper.childNodes[t].nodeType||2==n.commentsList.commentsWrapper.childNodes[t].nodeType)&&(n.commentsList.commentsWrapper.childNodes[t].style.display="none");n.commentsList.commentsWrapper.childNodes[n.commentsList.currentPage-1]?n.commentsList.commentsWrapper.childNodes[n.commentsList.currentPage-1].style.display="block":n.requestCommentListPage(n.commentsList.currentPage-1)}}else if(n.commentsList.currentPage>1){n.commentsList.currentPage-=1,n.commentsList.numPage.innerHTML=n.commentsList.currentPage+" / "+n.commentsList.pages_count,n.commentsList.currentPage<=1&&(n.commentsList.previousButton.style.display="none"),n.commentsList.nextButton.style.display="inline";for(t in n.commentsList.commentsWrapper.childNodes)(1==n.commentsList.commentsWrapper.childNodes[t].nodeType||2==n.commentsList.commentsWrapper.childNodes[t].nodeType)&&(n.commentsList.commentsWrapper.childNodes[t].style.display="none");n.commentsList.commentsWrapper.childNodes[n.commentsList.currentPage-1].style.display="block"}},fpauthentificator.prototype.setButtons=function(){var e,t=this;if(t.knownElements.links.length>0)for(var n=0;n<t.knownElements.links.length;n++)switch(e=t.knownElements.links[n].getAttribute("data-type")?t.knownElements.links[n].getAttribute("data-type"):"connect"){case"connect":break;case"action":t.knownElements.links[n].setAttribute("data-linkkey",n),t.knownElements.links[n].onclick=function(){var e=this.getAttribute("data-actionpremium")?!0:!1,n=t.buildParcoursPath(this,"login",this.getAttribute("data-action"),e);if(t.currentElementOperation=this,t.currentElementType="login",t.currentElementCallback=this.getAttribute("data-action"),t.currentActionPremium=e,t.recocurrentOperationKey=this.getAttribute("data-linkkey"),t.recocurrentOperationType="links",t.user){var o=n.main+"&js=true"+n["goto"],r={type:"script",attributes:{type:"text/javascript",src:o}};t.insertDomElement(r)}else t.openUserLoginCourse(n.main+n["goto"],n.main+n.baseUrl);return!1}}},fpauthentificator.prototype.buildParcoursPath=function(e,t,n,o){var r,a,i,s,c,l=this,m=[];if(r=e.getAttribute("data-appId")?e.getAttribute("data-appId"):l.passport.appId,"commentForm"==t?(a="1",s="middle",i="0"):(a=e.getAttribute("data-public")?e.getAttribute("data-public"):l.passport.defautlFormValues["data-public"],s=e.getAttribute("data-formlevel")?e.getAttribute("data-formlevel"):l.passport.defautlFormValues["data-formlevel"],i=e.getAttribute("data-update")?e.getAttribute("data-update"):l.passport.defautlFormValues["data-update"]),c=n?n:l.passport.defautlFormValues["data-goto"]&&l.passport.defautlFormValues["data-goto"].match(l.urlRegexp)?l.passport.defautlFormValues["data-goto"]:"refresh_parent_page",l.responsiveRun){var p=document.location.href.replace(document.location.hash,"");m.baseUrl="&goto_url="+encodeURIComponent(p)}return c.match(l.urlRegexp)&&(c=encodeURIComponent(c),m.baseUrl="&goto_url="+c),m.main=l.premiumHost.replace("http:/","https:/")+"/fpservice/fp_auth/login?app_id="+r+"&public="+a+"&force_update="+i+"&level_name="+s,o&&(m.main+="&action_premium=1"),m["goto"]="&callback="+c,m},fpauthentificator.prototype.setPassport=function(e){var t=this;t.passport={appId:e.appId,customFormLogo:"default"==e.customFormLogo?document.location.protocol+"//plus.lefigaro.fr/sites/default/themes/figaropremium/images/fplinks.png":e.customFormLogo,commentReplyContainerClass:e.commentReplyContainerClass?e.commentReplyContainerClass:null,defautlFormValues:{"data-goto":e.defautlFormValues["data-goto"],"data-formlevel":e.defautlFormValues["data-formlevel"],"data-public":e.defautlFormValues["data-public"]?e.defautlFormValues["data-public"]:"0","data-update":e.defautlFormValues["data-update"]?e.defautlFormValues["data-update"]:"0"}}},fpauthentificator.prototype.checkUserCookie=function(e){var t=this,n="figaro_toolbar",o=t.getCookie(n);if(o){var r=!1;t.user||(r=!0),t.user=t.cookieUnserialize(o);for(var a in t.user.roles)"Connect"==t.user.roles[a].toString()&&(t.availableUserForPost=!0)}e&&r&&("function"==typeof ffw_loadUserDataCookie?window.parent.ffw_loadUserDataCookie("",!0):"function"==typeof figaropremiumReloadUserBar&&window.parent.figaropremiumReloadUserBar())},fpauthentificator.prototype.userAccess=function(e){var t=this,n=t.buildParcoursPath(t.currentElementOperation,t.currentElementType,t.currentElementCallback,t.currentActionPremium);e?t.urlInspector(n["goto"].replace("&callback=","")):t.openUserLoginCourse(n.main+n["goto"],n.main+n.baseUrl)},fpauthentificator.prototype.insertDomElement=function(e){var t,n=this;if("text"==e.type)t=document.createTextNode(e.value);else if(t=document.createElement(e.type),e.attributes)for(var o in e.attributes)e.attributes.hasOwnProperty(o)&&t.setAttribute(o,e.attributes[o]);if("script"==e.type||"link"==e.type?document.getElementsByTagName("head")[0].appendChild(t):e.target&&e.target.appendChild(t),e.children)for(var r in e.children)e.children.hasOwnProperty(r)&&(e.children[r].target=t,n.insertDomElement(e.children[r]))},fpauthentificator.prototype.openUserLoginCourse=function(e,t){var n=this;if(n.responsiveRun=window.innerWidth<n.screenThresholdWidth,n.responsiveRun){var o={recocurrentOperationKey:n.recocurrentOperationKey,recocurrentOperationType:n.recocurrentOperationType,currentElementCallback:n.currentElementCallback,currentActionPremium:n.currentActionPremium};n.setCookie("fp-auth-data",JSON.stringify(o),120),document.location.href=t.replace("fpservice/fp_auth/login","user")}else n.openFpUserDialogBox(e)},fpauthentificator.prototype.closeFpUserDialogBox=function(){null!=document.getElementById("fp-dialog-screen-blocker")&&(document.getElementById("fp-dialog-screen-blocker").style.display="none",document.getElementById("fp-dialog-popup").style.display="none",document.getElementById("fp-dialog-iframe").style.display="none");var e=fpAuth;e.resetPwd&&1==e.resetPwd&&(e.setCookie("figaro_pwd","",-1,!0),e.resetPwd=!1,e.postInit())},fpauthentificator.prototype.openFpUserDialogBox=function(e){var t=this;if(null==document.getElementById("fp-dialog-screen-blocker")){var n=document.createElement("div");n.id="fp-dialog-screen-blocker",n.onclick=function(){return t.closeFpUserDialogBox(),!1},document.body.appendChild(n)}else n=document.getElementById("fp-dialog-screen-blocker");if(null==document.getElementById("fp-dialog-popup")){var o=document.createElement("div");o.id="fp-dialog-popup",document.body.appendChild(o);var r=document.createElement("div");r.id="fp-dialog-close-popup-wrapper",o.appendChild(r);var a=document.createElement("a");a.id="fp-dialog-close-popup",a.href="#",a.innerHTML="X",r.appendChild(a),a.onclick=function(){return t.closeFpUserDialogBox(),!1}}else o=document.getElementById("fp-dialog-popup");var i=t.getScreenInfos(document.body);if(n.style.height=i.h+"px",n.style.width=i.w+"px",n.style.display="block",window.innerWidth>940?o.style.left=(window.innerWidth-940)/2+"px":o.style.left=0,o.style.display="block",null==document.getElementById("fp-dialog-iframe")){var s=document.createElement("iframe");s.id="fp-dialog-iframe",s.name="fp-dialog-iframe",s.scrolling="auto",s.marginheight="0",s.marginwidth="0",s.frameBorder="0",document.getElementById("fp-dialog-popup").appendChild(s)}else document.getElementById("fp-dialog-iframe").style.display="block";document.getElementById("fp-dialog-iframe").src=e},fpauthentificator.prototype.resizeIframe=function(e){var t,n=this,o=parseInt(e),r=document.getElementById("fp-dialog-popup");if(n.currentActionPremium||r&&"block"==r.style.display){var a=90,i=window.innerHeight,s=o+a;t=document.getElementById("fp-dialog-iframe"),s>i?(r.style.top="20px",o=i-a-20):(r.style.top=(i-s-20)/2+"px",o+=a)}else{var c=document.getElementsByTagName("iframe");for(var l in c)"object"==typeof c[l]&&c[l].hasAttribute("class")&&c[l].className.match("fp-auth-iframe-form")&&(t=c[l])}t&&o>0&&(t.style.height=o+"px")},fpauthentificator.prototype.getScreenInfos=function(e){for(var t=e,n=t.offsetLeft||0,o=t.offsetTop||0,r=screen.height,a=screen.width;t=t.offsetParent;)n+=t.offsetLeft,o+=t.offsetTop,r+=window.innerHeight,a+=window.innerWidth;return{x:n,y:o,h:r,w:a}},fpauthentificator.prototype.getCookie=function(e){var t,n,o,r=document.cookie.split(";"),a=!1;for(t=0;t<r.length;t++)n=r[t].substr(0,r[t].indexOf("=")),o=r[t].substr(r[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,""),n==e&&(a=decodeURIComponent(o));return a},fpauthentificator.prototype.setCookie=function(e,t,n,o){var r=new Date;m=r.getTime()+1e3*n;var a=new Date(m),i=encodeURIComponent(t)+(null==n?"":"; expires="+a.toUTCString());o&&(i+=" ;path=/; domain=.lefigaro.fr"),document.cookie=e+"="+i},fpauthentificator.prototype.cookieUnserialize=function(v){if(!v)return null;var s,_un=function(v){s=v;for(var t,e,n,i;s;){switch(s.charAt(0)){case"s":return e=parseInt(s.substr(2,s.indexOf(":")+1)),t=s.substr(s.indexOf(":",2)+2,e),s=s.substr(s.indexOf(";",e+5)+1),t;case"i":return t=parseInt(s.substr(2,s.indexOf(";",2)+1)),s=s.substr(s.indexOf(";")+1),t;case"d":return t=parseFloat(s.substr(2,s.indexOf(";",2))),s=s.substr(s.indexOf(";")+1),t;case"b":return t=s.substr(2,s.indexOf(":")),s=s.substr(s.indexOf(";")+1),!("1"!==t);case"N":return s=s.substr(s.indexOf(";")+1),"";case"a":for(t=[],e=s.indexOf(":",2)-2,n=s.substr(2,e),s=s.substr(s.indexOf("{")+1),i=0;n>i;i++)t[_un(s)]=_un(s);return s=s.substr(s.indexOf("}")+1),t;case"O":default:e=s.indexOf(":",s.indexOf(":",s.indexOf(":")+2)+1)-1,
  tS="s"+s.substr(s.indexOf(":"),e)+";",o=s;var cN=_un(tS);try{t=eval("new "+cN+"()")}catch(e){t={}}for(s=o.substr(e),n=s.substr(2,s.indexOf(":",2)-2),s=s.substr(s.indexOf("{")+1),i=0;n>i;i++)t[_un(s)]=_un(s);return s=s.substr(s.indexOf("}")+1),t}return""}};return _un(v)},fpauthentificator.prototype.urlInspector=function(callback){var myObj=window.parent.fpAuth;callback=decodeURIComponent(callback),callback.match(myObj.urlRegexp)?window.location.href=callback:"function"==typeof eval(callback)?myObj.currentElementOperation&&myObj.currentElementOperation.hasAttribute("data-arg")?eval(callback+"("+myObj.currentElementOperation.getAttribute("data-arg")+")"):eval(callback+"()"):refresh_parent_page()},fpauthentificator.prototype.onload=function(){if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(null!=t.exec(e))var n=parseFloat(RegExp.$1);n>=6?window.onload=function(){setTimeout("if (typeof alreadyrunflag == 'undefined' || !alreadyrunflag){fpAuth.init();}",0)}:alert("Votre navigateur n'est pas supporté, veuillez le mettre à jours, ou changer de navigateur.")}else if("function"==typeof ffw_detectIE6)"undefined"==typeof document.domainApplicationToLoad&&(document.domainApplicationToLoad=[]),document.domainApplicationToLoad[document.domainApplicationToLoad.length]="fpAuth.init";else{var o=null;if(document.addEventListener)document.addEventListener("DOMContentLoaded",function(){o=1,fpAuth.init()},!1);else if(document.all&&!window.opera){document.write('<script id="contentloadtag" defer src="javascript:void(0)"></script>');var r=document.getElementById("contentloadtag");r.onreadystatechange=function(){"complete"==this.readyState&&(o=1,fpAuth.init())}}else if(/Safari/i.test(navigator.userAgent))var a=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(a),fpAuth.init())},10)}};var fpAuthBuildCommentsList=function(e){var t=window.fpAuth;if(1==e.data.status){var n=e.data.comments;n.comment_count>0?(t.commentsList.pages_count=n.pages_count,t.commentsList.pages[n.page_current]=n.comments,t.buildCommentsCurrentPage(n.page_current)):"undefined"!=typeof console&&"function"==typeof console.log&&console.log("Pas de de commentaires trouves pour ce node! revenez plus tard !")}else"undefined"!=typeof console&&"function"==typeof console.log&&console.log("Pas de node correspondant a la requete !")};fpauthentificator.prototype.searchNewRecoLinks=function(){for(var myObj=this,lotOfDivs=document.getElementsByTagName("div"),keys=[],k=0;k<myObj.recolinksType.length;k++)keys[myObj.recolinksType[k]]=0;for(var i=0;i<lotOfDivs.length;i++)for(var j=0;j<myObj.recolinksType.length;j++)if(lotOfDivs[i].className.match(myObj.recolinksType[j]+"-container")&&!lotOfDivs[i].className.match("knownfpAppLink")){lotOfDivs[i].className+=" knownfpAppLink";var prepared=myObj.prepareLink(myObj.recolinksType[j],lotOfDivs[i],keys[myObj.recolinksType[j]]);if(prepared){myObj.recolinksContainer[myObj.recolinksType[j]][keys[myObj.recolinksType[j]]]=lotOfDivs[i],myObj.recolinks[myObj.recolinksType[j]][keys[myObj.recolinksType[j]]]=lotOfDivs[i].children[0];var InfosGetterPropal="myObj.linksGetInfos"+myObj.recolinksType[j];"function"==typeof eval(InfosGetterPropal)?eval(InfosGetterPropal)(keys[myObj.recolinksType[j]],myObj.recolinksType[j],myObj.recolinks[myObj.recolinksType[j]][keys[myObj.recolinksType[j]]]):myObj.linksGetInfos(keys[myObj.recolinksType[j]],myObj.recolinksType[j],myObj.recolinks[myObj.recolinksType[j]][keys[myObj.recolinksType[j]]]),myObj.linksCheckIfUserExists(keys[myObj.recolinksType[j]],myObj.recolinksType[j]),keys[myObj.recolinksType[j]]++}}myObj.setButtons();for(var key in myObj.recoqueries)myObj.insertDomElement(myObj.recoqueries[key])},fpauthentificator.prototype.prepareLink=function(e,t,n){var o,r,a=this;switch(t.getElementsByTagName("a").length>0?(o=t.getElementsByTagName("a")[0],o.innerHTML=""):o=document.createElement("a"),e){case"recommander":o.href=a.premiumHost+"/fpservice/recommander/"+t.getAttribute("data-type")+"/"+t.getAttribute("data-appId")+"/"+t.getAttribute("data-cid"),t.getAttribute("data-url")&&o.setAttribute("data-url",t.getAttribute("data-url")),r=document.createTextNode("Recommander");var i=document.createElement("span");o.appendChild(i);break;case"suivre":r=document.createTextNode("Suivre"),o.href=a.premiumHost+"/fpservice/follow/membre/"+t.getAttribute("data-appId")+"/"+t.getAttribute("data-uid");break;case"suivretag":r=document.createTextNode("Suivre"),o.href=a.premiumHost+"/fpservice/follow/tag/"+encodeURIComponent(t.getAttribute("data-term"));break;case"selectionner":var s=!1,c={8:"Journaliste",9:"Community+Manager"};if(a.user)for(role in a.user.roles)s=!!c[role]||s;if(!s)return t.parentNode.removeChild(t),!1;r=document.createTextNode("Sélectionner"),o.href=a.premiumHost+"/jsonp/select_comment?callback=fpComActionsJsCallBack&comment_id="+t.getAttribute("data-cid")}o.appendChild(r),t.innerHTML="",t.appendChild(o);var l=t.getElementsByTagName("a")[0];return l.className+=" fpAuth",l.setAttribute("data-type","action"),l.setAttribute("data-action","fpAuth.actionDispatcher"),l.setAttribute("fpApp-key",n),l.setAttribute("fpApp-type",e),l.setAttribute("fpApp-appid",t.getAttribute("data-appId")?t.getAttribute("data-appId"):a.passport.appId),l.setAttribute("data-actionpremium","true"),l.setAttribute("data-public","1"),l.setAttribute("data-update","0"),l.setAttribute("data-formlevel","middle"),!0},fpauthentificator.prototype.getMetaContent=function(e){for(var t=document.getElementsByTagName("meta"),n=0;n<t.length;n++)if(t[n].getAttribute("property")==e)return t[n].getAttribute("content");return""},fpauthentificator.prototype.actionDispatcher=function(){var e=window.fpAuth,t=fpAuth.currentElementOperation;if(t){e.recocurrentOperationKey=t.getAttribute("fpApp-key"),e.recocurrentOperationType=t.getAttribute("fpApp-type");var n=(t.getAttribute("fpApp-appid"),t.href+"/fpComActionsJsCallBack"),o=e.getMetaContent("og:url");!o&&t.getAttribute("data-url")&&(o=t.getAttribute("data-url")),o&&(n+="?url="+encodeURIComponent(o));var r={type:"script",attributes:{type:"text/javascript",src:n}};fpAuth.insertDomElement(r)}},fpauthentificator.prototype.userConnexionCallBack=function(){var e=this;e.checkUserCookie(),e.actionDispatcher()};var followLinkMouseOver=function(e){var t=e.childNodes[0],n=t.title,o=t.innerHTML,r=t.className;t.innerHTML=n,t.title=o,r.match("fpApp-follow-abonne")?(t.className="fpApp-follow-unfollow",e.className.replace("fpApp-follow-abonne","fpApp-follow-unfollow")):r.match("fpApp-follow-unfollow")&&(t.className="fpApp-follow-abonne",e.className.replace("fpApp-follow-unfollow","fpApp-follow-abonne"))};fpauthentificator.prototype.linksGetInfos=function(e,t,n){var o=this,r=n.href.split("/");if(o.recolinksInfos[t][e]={action:r[4],type:r[5],appId:r[6],remoteId:r[7]},""==r[4]||""==r[5]||""==r[6]||""==r[7])o.recolinksContainer[t][e].style.display="none",o.recolinks[t][e].style.display="none";else{var a,i=o.recolinksInfos[t][e].action+"_"+o.recolinksInfos[t][e].type;switch(i){case"recommander_article":a="recommander_node";break;case"recommander_commentaire":a="recommander_comment";break;case"recommander_status":a="recommander_fb";break;case"follow_membre":case"unfollow_membre":a="suivre_membre"}if(o.recogetInfos[a]||(o.recogetInfos[a]=[]),o.recogetInfos[a][o.recolinksInfos[t][e].appId]||(o.recogetInfos[a][o.recolinksInfos[t][e].appId]=[]),!o.recogetInfos[a][o.recolinksInfos[t][e].appId][o.recolinksInfos[t][e].remoteId]){o.recogetInfos[a][o.recolinksInfos[t][e].appId][o.recolinksInfos[t][e].remoteId]="pending";var s=n.href.replace(o.recolinksInfos[t][e].type+"/",o.recolinksInfos[t][e].type+"/infos/"),c=s.replace("unfollow","follow");o.recoqueries[o.recoqueries.length]={type:"script",attributes:{type:"text/javascript",src:c}}}}},fpauthentificator.prototype.linksGetInfosselectionner=function(e,t,n){var o=window.fpAuth,r="selectionner";if(o.recolinksInfos[t][e]={action:r,appId:o.passport.appId,contentId:n.parentNode.getAttribute("data-cid")},o.recogetInfos[r]||(o.recogetInfos[r]=[]),o.recogetInfos[r][o.recolinksInfos[t][e].appId]||(o.recogetInfos[r][o.recolinksInfos[t][e].appId]=[]),!o.recogetInfos[r][o.passport.appId][o.recolinksInfos[t][e].contentId]){o.recogetInfos[r][o.passport.appId][o.recolinksInfos[t][e].contentId]="pending";var a=n.href;a=a.replace("select_comment","check_selected_comment"),a=a.replace("fpComActionsJsCallBack","getLinksInfosJsonpCallBack"),o.recoqueries[o.recoqueries.length]={type:"script",attributes:{type:"text/javascript",src:a}}}},fpauthentificator.prototype.linksGetInfossuivretag=function(e,t,n){var o=window.fpAuth,r=n.parentNode.getAttribute("data-term");if(o.recolinksInfos[t][r]={action:t,appId:o.passport.appId,term:r},o.recogetInfos[t]||(o.recogetInfos[t]=[]),!o.recogetInfos[t][r]){o.recogetInfos[t][r]="pending";var a=n.href.replace("tag/","tag/infos/");a=a.replace("unfollow","follow"),o.recoqueries[o.recoqueries.length]={type:"script",attributes:{type:"text/javascript",src:a}}}},fpauthentificator.prototype.linksCheckIfUserExists=function(e,t){var n=this;if("suivre"!=t||document.location.host.match("plus.lefigaro.fr"))return!1;var o=n.recolinksContainer[t][e].getAttribute("data-appid"),r=n.recolinksContainer[t][e].getAttribute("data-uid"),a=n.premiumHost+"/fpservice/user_graph?appid="+o+"&remote_id="+r+"&jsonp_callback=window.fpAuth.linksCheckIfUserExistsCallback";n.recoqueries[n.recoqueries.length]={type:"script",attributes:{type:"text/javascript",src:a}}},fpauthentificator.prototype.linksCheckIfUserExistsCallback=function(e){var t=this;if(!e.status){var n,o;for(var r in t.recolinksContainer.suivre)n=t.recolinksContainer.suivre[r].getAttribute("data-appid"),o=t.recolinksContainer.suivre[r].getAttribute("data-uid"),e.appid==n&&e.remote_id==o&&(t.recolinksContainer.suivre[r].style.display="none","undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("FpAuth Error :: Pas de correspondance trouve avec cet utilisateur cote premium :: ["+n+"]["+o+"]"))}};var recommanderLinksInfosCallBack=function(action,data){var myObj=window.fpAuth,actionFunctionName,typeLink;if(data){switch(action){case"suivre_membre":typeLink="suivre";break;case"suivre_tag":typeLink="suivretag";for(var tagkey in data)if(tagkey){var termkey=tagkey;break}return myObj.recogetInfos[typeLink][termkey]=data,myObj.recolinksDatas[typeLink][termkey]=data,actionFunctionName=typeLink+"UpdateActions",void eval(actionFunctionName)(termkey,data);default:typeLink="recommander"}var appId,remoteId;for(var key in data){appId=key;for(var k in data[key])remoteId=k}appId&&remoteId&&(myObj.recogetInfos[action][appId][remoteId]=data?data:0);for(var linkKey in myObj.recolinksInfos[typeLink])("suivre"==typeLink||myObj.recolinksInfos[typeLink][linkKey].action==typeLink&&myObj.recolinksInfos[typeLink][linkKey].appId==appId&&myObj.recolinksInfos[typeLink][linkKey].remoteId==remoteId)&&(myObj.recolinksDatas[typeLink][linkKey]=data,actionFunctionName=typeLink+"UpdateActions",eval(actionFunctionName)(typeLink,linkKey))}},getLinksInfosJsonpCallBack=function(result){var myObj=window.fpAuth,appId=myObj.passport.appId,type=result.data.type,contentId=result.data.content_id;myObj.recogetInfos[type][appId][contentId]=!0;for(var linkKey in myObj.recolinksInfos[type])if(myObj.recolinksInfos[type][linkKey].action==type&&myObj.recolinksInfos[type][linkKey].appId==appId&&myObj.recolinksInfos[type][linkKey].contentId==contentId){myObj.recolinksDatas[type][linkKey]=result.data;var actionFunctionName=type+"UpdateActions";"function"==typeof eval(actionFunctionName)&&eval(actionFunctionName)(type,linkKey,result)}},recommanderUpdateActions=function(e,t){var n=window.fpAuth;if("undefined"!=typeof n.recolinksInfos[e][t]){var o=n.recolinksDatas[e][t][n.recolinksInfos[e][t].appId][n.recolinksInfos[e][t].remoteId];if("undefined"==typeof o)n.recolinks[e][t].style.display="none";else if(o&&null!=n.recolinksInfos[e][t].remoteId&&0!=o.count&&(recommanderUpdateLink(t,e,o.count),fpAuth.user)){for(var r=o.users,a=!1,i=0;i<r.length;i++)r[i]==fpAuth.user.uid.toString()&&(a=!0);1==a&&(n.recolinks[e][t].className+=" flagged",n.recolinks[e][t].innerHTML="<span></span>Recommand&eacute;")}}},selectionnerUpdateActions=function(e,t,n){var o=window.fpAuth;n.data.status&&(o.recolinksContainer[e][t].className+=" flagged",o.recolinksContainer[e][t].removeChild(o.recolinks[e][t]),o.recolinksContainer[e][t].innerHTML="Sélectionné")},suivreUpdateActions=function(e,t){var n=window.fpAuth;if(""!=n.recolinksDatas[e][t]&&null!=fpAuth.user.uid){var o=n.recolinksInfos[e][t].appId,r=n.recolinksInfos[e][t].remoteId,a=fpAuth.user.uid.toString();null!=n.recolinksDatas[e][t][o][a]&&null!=n.recolinksDatas[e][t][o][a][r]&&null!=n.recolinksDatas[e][t][o][a][r].follow_statement&&suivreSubmittedCallBack(t,e,n.recolinksDatas[e][t][o][a][r].follow_statement,!1)}},suivretagUpdateActions=function(e,t){var n=window.fpAuth,o=!1,r=n.recolinks.suivretag;for(var a in r){var i=r[a];if(e==i.parentNode.getAttribute("data-term")){if("unknown_term"==t[e].error)return n.recolinksContainer.suivretag[a].style.display="none",void("undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("ERROR : Tag "+e+" inconnu."));if("flag_error"==t[e].error)return void("undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("ERROR : Probleme au chargement du tag "+e+"."))}}for(var a in t[e].users)if(t[e].users[a]==n.user.uid){o=!0;break}if(o)for(var a in r){var i=r[a];if(e==i.parentNode.getAttribute("data-term")){i.innerHTML="Abonné(e)",i.href=i.href.replace("follow","unfollow"),i.className="fpApp-follow-abonne";var s=i.parentNode;s.className+=" fpApp-follow-abonne",i.title="Ne plus suivre",i.parentNode.onmouseover=function(){followLinkMouseOver(this)},i.parentNode.onmouseout=function(){followLinkMouseOver(this)}}}},recommanderUpdateLink=function(e,t,n){var o=window.fpAuth,r=o.recolinksContainer[t][e].getElementsByTagName("span")[1];null==r&&(r=document.createElement("span"),r.className=o.recorecommanderLinksCountClassName,o.recolinksContainer[t][e].appendChild(r)),countText=document.createTextNode(n),r.innerHTML="",r.appendChild(countText)},fpComActionsJsCallBack=function(result){var myObj=window.fpAuth;if("unlogged"==result){var path=fpAuth.buildParcoursPath(myObj.recolinks[myObj.recocurrentOperationType][myObj.recocurrentOperationKey],"recommander","fpApp.userConnexionCallBack",!0);fpAuth.openUserLoginCourse(path.main+path["goto"],path.main+path.baseUrl)}else{var functionName="";"ever_flagged"==result&&"recommander"==myObj.recocurrentOperationType?(functionName=myObj.recocurrentOperationType+"OpendfpShareDialog",eval(functionName)(myObj.recolinks[myObj.recocurrentOperationType][myObj.recocurrentOperationKey])):(functionName=myObj.recocurrentOperationType+"SubmittedCallBack",eval(functionName)(myObj.recocurrentOperationKey,myObj.recocurrentOperationType,result,!0)),fpAuth.checkUserCookie()}},recommanderSubmittedCallBack=function(e,t,n,o){var r=window.fpAuth;switch(n){case"unknow_article":case"flag_error":recommanderUpdateLink(e,t,"null"),r.recolinks[t][e].innerHTML="Erreur";break;default:parseInt(n)>0&&(recommanderUpdateLink(e,t,n),r.recolinks[t][e].className+=" flagged",r.recolinks[t][e].innerHTML="<span></span>Recommand&eacute;")}},selectionnerSubmittedCallBack=function(e,t,n,o){var r=window.fpAuth;switch(n.data.status){case 1:r.recolinksContainer[t][e].className+=" flagged",r.recolinksContainer[t][e].removeChild(r.recolinks[t][e]),r.recolinksContainer[t][e].innerHTML="Sélectionné";break;case-1:for(containerKey in r.recolinksContainer[t])r.recolinksContainer[t][containerKey].parentNode.removeChild(r.recolinksContainer[t][containerKey]);mObj.checkUserCookie()}},suivreSubmittedCallBack=function(e,t,n,o){var r=window.fpAuth;1==o&&"undefined"!=typeof Drupal&&"undefined"!=typeof Drupal.settings&&"undefined"!=typeof Drupal.settings.fpcomactions&&"undefined"!=typeof Drupal.settings.fpcomactions.account_privacy&&1==Drupal.settings.fpcomactions.account_privacy&&window.location.reload(),r.recolinks[t][e].parentNode.onmouseover=null,r.recolinks[t][e].parentNode.onmouseout=null;var a,i,s,c,l;switch(n){case"RELATION_APROVED":a="Abonné(e)",i="Ne plus suivre",l="fpApp-follow-abonne",r.recolinks[t][e].href.match("unfollow")||(s="follow",c="unfollow");break;case"RELATION_WAITING":a="En attente",i="Annuler",l="fpApp-follow-abonne",r.recolinks[t][e].href.match("unfollow")||(s="follow",c="unfollow");break;case"RELATION_DELETE":a="Suivre",i="Suivre",l="fpApp-follow-follow",r.recolinks[t][e].href.match("unfollow")&&(s="unfollow",c="follow");break;case"RELATION_REJECT":case"ERROR":a="Erreur",l="fpApp-follow-follow",window.location.reload()}if(""!=a&&(r.recolinks[t][e].innerHTML=a),""!=i&&(r.recolinks[t][e].title=i),""!=l){r.recolinks[t][e].className=l;var m=r.recolinks[t][e].parentNode;m.className.replace(" fpApp-follow-abonne",""),m.className.replace(" fpApp-follow-unfollow",""),m.className+=" "+l}s!=c&&(r.recolinks[t][e].href=r.recolinks[t][e].href.replace(s,c)),r.recolinks[t][e].parentNode.onmouseover=function(){followLinkMouseOver(this)},r.recolinks[t][e].parentNode.onmouseout=function(){followLinkMouseOver(this)}},suivretagSubmittedCallBack=function(e,t,n,o){var r=window.fpAuth;r.recolinks[t][e].parentNode.onmouseover=null,r.recolinks[t][e].parentNode.onmouseout=null;var a,i,s,c,l,m=r.recolinks[t][e].parentNode.getAttribute("data-term");switch(n){case"FOLLOW":case"ever_flagged":a="Abonné(e)",i="Ne plus suivre",l="fpApp-follow-abonne",r.recolinks[t][e].href.match("unfollow")||(s="follow",c="unfollow");break;case"UNFOLLOW":a="Suivre",i="Suivre",l="fpApp-follow-follow",r.recolinks[t][e].href.match("unfollow")&&(s="unfollow",c="follow");break;case"unknown_term":return r.recolinksContainer[t][e].style.display="none",void("undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("ERROR : Tag "+m+" inconnu."));case"anonymous_user":return void("undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("ERROR : l'utilisateur n'est pas loggue."));case"ERROR":case"flag_error":return void("undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log("ERROR : Erreur lors du traitement de recuperation du tag "+m+"."))}if(""!=a&&(r.recolinks[t][e].innerHTML=a),""!=i&&(r.recolinks[t][e].title=i),""!=l){r.recolinks[t][e].className=l;var p=r.recolinks[t][e].parentNode;p.className.replace(" fpApp-follow-abonne",""),p.className.replace(" fpApp-follow-unfollow",""),p.className+=" "+l}s!=c&&(r.recolinks[t][e].href=r.recolinks[t][e].href.replace(s,c)),r.recolinks[t][e].parentNode.onmouseout=function(){r.recolinks[t][e].parentNode.onmouseover=function(){followLinkMouseOver(this)},r.recolinks[t][e].parentNode.onmouseout=function(){followLinkMouseOver(this)}}},recommanderOpendfpShareDialog=function(e){for(var t=!1,n=e.parentNode.getElementsByTagName("div"),o=0;o<n.length;o++)n[o].className.match("fp-share-dialog-block")&&(t=!0,n[o].style.display="block");if(!t){var r=document.createElement("div");r.className="fp-share-dialog-block";var a="<p><strong>Vous avez d&eacute;j&agrave; recommand&eacute; ce contenu.</strong><br />";a+="Vous pouvez &eacute;galement le partager sur Facebook ou Twitter.</p>",r.innerHTML=a;var i=document.createElement("span");i.innerHTML="X",r.appendChild(i),e.parentNode.appendChild(r),i.onclick=function(){closefpShareDialog(r,"click")}}},closefpShareDialog=function(e){e.style.display="none"};if("undefined"==typeof refresh_parent_page)var refresh_parent_page=function(){var e=document.location.href.replace(document.location.hash,"");e.match("fp_callback=window.parent.refresh_parent_page()")&&(e=e.replace("fp_callback=window.parent.refresh_parent_page()","")),window.parent.document.location.href=e};fpauthentificator.prototype.pingFidji=function(){var e=this;if(e.premiumHost.match(e.defaultPremiumHost)){var t=e.getMetaContent("fp:remote_id"),n=e.getMetaContent("fp:app_id"),o=e.getMetaContent("og:url");if(t&&n&&o){var r=document.location.protocol+"//api.fidji.lefigaro.fr/ping/?url="+o,a={type:"script",attributes:{type:"text/javascript",src:r}};e.insertDomElement(a)}}},function(){"undefined"==typeof window.fpAuth&&(window.fpAuth=new fpauthentificator)}();
